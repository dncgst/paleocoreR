---
output:
  html_document:
    theme: united
    highlight: pygments
---


Using the Paleocore R API Interface
========================================================

This demo shows the functionality of the PaleoCore API using the Turkana dataset as an example. 

## Preliminaries
The PaleocoreR package is not yet on CRAN, so you cannot install it using the normal R package installation method.  Instead you can use a function called `install_github()` from the `devtools` package to install the package from the [paleocoreR github page](http://paleocore.github.com/paleocoreR), as shown below.

```{r echo = TRUE, warning=FALSE, message=FALSE}
library(devtools)
install_github("paleocore/paleocoreR")
library(paleocoreR)

#also load the ggplot2 package for graphing.  If this package is not installed already you can try
#install.packages("ggplot2")
library(ggplot2)
```
## First, we can check which datasets are available

```{r list_pcore_datasets}
list_pcore_datasets()
```

## Authentication

Some datasets require authentication (turkana does not).  You can store your PaleoCore username and api_key for authentication using the convenience function `set_pcore_credentials()`.  If you have a paleocore login account, you can obtain your api_key at [http://paleocore.org/apikey](http://paleocore.org/apikey). If you need to create a login account please [contact the paleocore administrators](http://paleocore.org/about). 

```{r authentication}
set_pcore_credentials(username="proconsul", api_key="s93jsp9823jd83mw2md922d93kd73f23kdf23ld7")
```

## See which fields can be filtered on in the Turkana dataset

```{r listfilters}
list_pcore_filters(dataset="turkana")
```


## Getting data using `get_pcore_data()`

The workhorse function of the `paleocoreR` package is called `get_pcore_data()`.  Here we will download all of the bovid records from the turkana dataset.  
```{r getbovids, cache=TRUE}
bovids <- get_pcore_data(dataset = "turkana", family="Bovidae", limit=0)
```

This results in an object called `bovids` that contains all the bovid records from the Turkana dataset.  We can look at the structure of our data using the `str()` function. 

```{r}
str(bovids)
```

## Plots

We can now do a great many useful things with this dataset.  For instance, we might plot a histogram of the number of identified bovid specimens by tribe. 

```{r plotbytribe,  fig.width=14, height=9}
qplot(data=bovids, x=tribe, main="# Bovid Specimens by Tribe")
```

